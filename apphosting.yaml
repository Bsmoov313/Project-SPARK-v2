# apphosting.yaml – Firebase App Hosting config for SPARK v2 (Node.js)

run:
  cpu: 1
  memoryMiB: 512
  minInstances: 0
  maxInstances: 3

env:
  # Secrets from Google Secret Manager (you already created + granted access)
  secrets:
    - variable: GOOGLE_CLIENT_ID
      secret: GOOGLE_CLIENT_ID
    - variable: GOOGLE_CLIENT_SECRET
      secret: GOOGLE_CLIENT_SECRET
    - variable: GOOGLE_REFRESH_TOKEN
      secret: GOOGLE_REFRESH_TOKEN

  # Plain environment variables
  variables:
    NODE_ENV: "production"

    # REQUIRED for tests to pass:
    # Your hosted app URL (copy from App Hosting > Overview)
    APP_HOST_URL: "https://project-spark-v2--project-spark-v2.us-central1.hosted.app"

    # For quick testing, point the processor to our local echo endpoint.
    # Later, change this to your real processor URL.
    PROCESS_WEBHOOK_URL: "https://project-spark-v2--project-spark-v2.us-central1.hosted.app/dev/echo"

    # Put your real Cube ACR *root* Drive folder id here when you’re ready.
    # Leaving it blank will make /test/drive-notify complain (by design).
    DRIVE_FOLDER_ID: "1L7MTRrJMpH1YE-V8GP7T6cYWpxSdgkQS"

    # Optional shared-secret for Drive webhook verification
    DRIVE_VERIFY_TOKEN: ""
